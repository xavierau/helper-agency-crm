(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d65bd"],{"71e2":function(t,n,e){"use strict";e.r(n);var a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"EditInvoice"},[t.invoice?e("CCard",[e("CCardHeader",[e("h4",{staticClass:"d-block"},[t._v(" Invoice "),e("button",{staticClass:"btn btn-warning btn-sm float-right",on:{click:function(n){return n.preventDefault(),t.showSupersedeModal.apply(null,arguments)}}},[e("i",{staticClass:"far fa-clone"}),t._v(" Supersede ")])])]),e("CCardBody",[e("CreateNewInvoiceForm",{attrs:{"disabled-fields":["client_id","contract.id"],"previous-invoice":t.invoice.previousInvoice,"form-data":t.invoice}}),e("div",{staticClass:"row p-3"},[e("router-link",{staticClass:"btn btn-secondary",attrs:{to:{name:"Invoices"}}},[e("i",{staticClass:"far fa-arrow-alt-circle-left"}),t._v(" Back ")]),e("button",{staticClass:"btn btn-success ml-auto",on:{click:function(n){return n.preventDefault(),t.update.apply(null,arguments)}}},[e("i",{staticClass:"fas fa-check"}),t._v(" Update ")])],1)],1)],1):e("CCard",[e("CCardHeader",[e("h4",[t._v("Loading...")])])],1),e("CModal",{attrs:{show:t.showSupersede,color:"warning",size:"lg","close-on-backdrop":!1,title:"Supersede Invoice"},on:{"update:show":function(n){t.showSupersede=n}},scopedSlots:t._u([{key:"footer",fn:function(){return[e("button",{staticClass:"btn btn-secondary btn-sm",on:{click:function(n){t.showSupersede=!1}}},[t._v("Close")]),e("button",{staticClass:"btn btn-warning btn-sm",on:{click:t.supersedeInvoice}},[t._v("Supersede with new contract")])]},proxy:!0}])},[e("CCard",[e("CCardBody",[e("h5",[t._v("New Contract")]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Applicant")]),e("my-v-select",{attrs:{options:t.applicants,label:"name","search-func":t.fetchApplicants},model:{value:t.new_applicant,callback:function(n){t.new_applicant=n},expression:"new_applicant"}})],1)]),e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Contract Number")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_contract_number,expression:"new_contract_number"}],staticClass:"form-control",domProps:{value:t.new_contract_number},on:{input:function(n){n.target.composing||(t.new_contract_number=n.target.value)}}})])])])])],1)],1)],1)},i=[],c=e("ebe3"),o=e("7ed9"),s=e("1613"),r=e("93f0"),u=e("11c1"),l=e("1bbb"),d={name:"EditInvoice",components:{CreateNewInvoiceForm:s["a"],MyVSelect:r["a"]},data:function(){return{showSupersede:!1,invoice:null,new_applicant:null,new_contract_number:null,applicantPaginator:null}},computed:{applicants:function(){return this.applicantPaginator?this.applicantPaginator.data:[]},canEdit:function(){return this.$store.getters.can("agency-finance:invoice.edit")}},created:function(){this.fetchInvoice()},methods:{showSupersedeModal:function(){this.showSupersede=!0},fetchInvoice:function(){var t=this;o["a"].get(c["a"].show(this.$route.params.id)).then((function(n){var e=n.data;e.items.forEach((function(t){return t.uuid=Object(u["v4"])()})),t.invoice=e})).catch((function(t){return console.log(t)}))},update:function(){var t=this;o["a"].put(c["a"].update(this.$route.params.id),this.invoice).then((function(){return t.$toasted.success("Invoice is update")})).then((function(){return t.$router.push({name:"Invoices"})})).catch((function(n){return t.$toasted.error("Something wrong.",n.message)}))},fetchApplicants:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o["a"].get(l["a"].list,{params:{"filter[search]":n}}).then((function(n){var e=n.data;return t.applicantPaginator=e})).catch((function(t){return console.log(t)}))},supersedeInvoice:function(){var t=this,n=Object.assign({},this.invoice);n.items=null,n.invoice_id=this.invoice.id,n.contract.id="new",n.contract.contract_number=this.new_contract_number,n.contract.applicant.id=this.new_applicant.id,o["a"].post(c["a"].supersede(this.invoice.id),n).then((function(n){var e=n.data;return t.$router.push({name:"Edit Invoice",params:{id:e.id}})})).then((function(){return t.$toasted.success("new invoice created")})).catch((function(n){return t.$toasted.error("something wrong!"+n.message)}))}}},p=d,v=e("2877"),h=Object(v["a"])(p,a,i,!1,null,"128a75a8",null);n["default"]=h.exports}}]);