(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b94a3f3"],{"132f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ContractTypeIndex"},[a("CCard",[a("CCardHeader",{staticClass:"d-flex justify-content-between align-content-center"},[a("h5",{staticClass:"m-0"},[t._v("All Contract Types")]),a("button",{staticClass:"btn btn-sm btn-success",on:{click:function(e){t.showCreateModal=!t.showCreateModal}}},[a("i",{staticClass:"fa fa-plus"}),t._v(" Type ")])]),t.items?a("CCardBody",[a("CDataTable",{attrs:{items:t.items,fields:t.fields,loading:t.isLoading,hover:"","items-per-page":15,"column-filter":"","table-filter":"",sorter:""},scopedSlots:t._u([{key:"actions",fn:function(e){var n=e.item;return[a("td",[a("button",{staticClass:"ml-1 btn btn-sm btn-icon btn-info",on:{click:function(e){return t.showAttachModal(n)}}},[a("i",{staticClass:"fas fa-cubes"})]),a("button",{staticClass:"ml-1 btn btn-sm btn-icon btn-info",on:{click:function(e){return t.showAttachDocumentModal(n)}}},[a("i",{staticClass:"far fa-folder-open"})]),a("button",{staticClass:"ml-1 btn btn-sm btn-icon btn-info",on:{click:function(e){return t.showAssignTemplate(n)}}},[a("i",{staticClass:"fa fa-print"})])])]}}],null,!1,2855053765)})],1):a("CCardBody",[a("h4",[t._v("Loading...")])])],1),a("CModal",{attrs:{show:t.showCreateModal,title:"Create New Contract Date",color:"success",static:"",size:"xl"},on:{"update:show":function(e){t.showCreateModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("button",{staticClass:"btn btn-success",on:{click:t.submit}},[t._v("Create")])]},proxy:!0}])},[a("contract-type-form",{attrs:{"form-data":t.formData},on:{"update:formData":function(e){t.formData=e},"update:form-data":function(e){t.formData=e}}})],1),a("CModal",{attrs:{show:t.showAssignModal,title:"Contract Type Has Dates",color:"success",static:"",size:"xl"},on:{"update:show":function(e){t.showAssignModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span")]},proxy:!0}])},[a("contract-date-table",{attrs:{dates:t.dates,"reload-dates":t.fetchContractType,contract_type:t.selected_contract_type},on:{reorder:t.reorder}})],1),a("CModal",{attrs:{show:t.showAssignDocumentModal,title:"Contract Type Has Documents",color:"success",static:"",size:"xl"},on:{"update:show":function(e){t.showAssignDocumentModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span")]},proxy:!0}])},[a("contract-document-table",{attrs:{documents:t.documents,"reload-documents":t.fetchContractType,contract_type:t.selected_contract_type},on:{reorder:t.reorderDoc}})],1),a("CModal",{attrs:{show:t.showTemplateModal,title:"Contract Type Has Print Template",color:"success",static:"",size:"xl"},on:{"update:show":function(e){t.showTemplateModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span")]},proxy:!0}])},[a("ContractTemplateTable",{attrs:{templates:t.templates,contract_type:t.selected_contract_type,reload:t.fetchContractType}})],1)],1)},o=[],r=a("7ed9"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"form-group"},[a("label",[t._v("Label")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.label,expression:"formData.label"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.formData.label},on:{input:function(e){e.target.composing||t.$set(t.formData,"label",e.target.value)}}})])])},c=[],i={name:"ContractTypeForm",props:{formData:{type:Object,required:!0}}},d=i,l=a("2877"),u=Object(l["a"])(d,s,c,!1,null,"1630ecfc",null),f=u.exports,p={list:"/api/agencycontract/contract_types",show:function(t){return"/api/agencycontract/contract_types/".concat(t)},store:"/api/agencycontract/contract_types",all_dates:"/api/agencycontractdate/all_dates",assign:"/api/agencycontractdate/assign",ordering:"/api/agencycontractdate/ordering",all_docs:"/api/agencycontractdoc/all_docs",assign_doc:"/api/agencycontractdoc/assign",ordering_doc:"/api/agencycontractdoc/ordering",all_templates:"/api/agencytemplate/templates/all",assign_templates:function(t){return"/api/agencytemplate/templates/contract_types/".concat(t)},remove_templates:function(t,e){return"/api/agencytemplate/templates/".concat(e,"/contract_types/").concat(t)}},m=p,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h4",[t._v("Add Dates "),a("button",{staticClass:"btn btn-sm btn-icon btn-success",on:{click:function(e){t.showAssignModal=!0}}},[a("i",{staticClass:"fa fa-plus"})])]),t.dates.length>0?a("div",[a("div",{staticClass:"drop-zone",on:{drop:function(e){return t.onDrop(e,1)},dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()}}},t._l(t.ordered_dates,(function(e){return a("div",{key:e.is,staticClass:"drag-el border rounded p-2",attrs:{draggable:"","data-id":e.id},on:{dragstart:function(a){return t.startDrag(a,e)},dragover:function(a){return t.dragOver(a,e)}}},[t._v(" "+t._s(e.label)+" "),e.is_required?a("span",{staticClass:"badge badge-info"},[t._v("Required")]):t._e()])})),0)]):a("div",[t._v(" No date assigned to the contract type ")]),a("CModal",{attrs:{title:"Assign date to contract type",color:"success",show:t.showAssignModal},on:{"update:show":function(e){t.showAssignModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("div",{staticClass:"d-block w-100"},[a("button",{staticClass:"d-inline-block btn btn-secondary",on:{click:t.closeModal}},[t._v("Close")]),a("button",{staticClass:" d-inline-block btn btn-success float-right",on:{click:t.submit}},[t._v("Assign")])])]},proxy:!0}])},[a("div",{staticClass:"form-group"},[a("label",[t._v("Date")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.contract_date_id,expression:"formData.contract_date_id"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.formData,"contract_date_id",e.target.multiple?a:a[0])}}},t._l(t.available_dates,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.label))])})),0)]),a("div",{staticClass:"form-group"},[a("label",[t._v("Order")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.order,expression:"formData.order"}],staticClass:"form-control",attrs:{type:"number",min:"0"},domProps:{value:t.formData.order},on:{input:function(e){e.target.composing||t.$set(t.formData,"order",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",[t._v("Is required")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.is_required,expression:"formData.is_required"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.formData,"is_required",e.target.multiple?a:a[0])}}},[a("option",{domProps:{value:!0}},[t._v("Required")]),a("option",{domProps:{value:!1}},[t._v("Optional")])])])])],1)},h=[],v=a("2ef0"),g=a.n(v),b={name:"ContractDateTable",props:{contract_type:{type:Object},dates:{type:Array,required:!0},reloadDates:{type:Function,required:!0}},data:function(){return{showAssignModal:!1,draggingId:null,dragOverId:null,all_dates:[],formData:{contract_date_id:null,order:null,is_required:!1}}},computed:{ordered_dates:function(){return g.a.sortBy(this.dates,["order","label"])},available_dates:function(){var t=this.dates.map((function(t){return t.id}));return g.a.filter(this.all_dates,(function(e){return-1===t.indexOf(e.id)}))}},mounted:function(){var t=this;r["a"].get(m.all_dates).then((function(e){var a=e.data;return t.all_dates=a})).catch((function(e){var a=e.error;return t.$toasted.error(a.message())}))},methods:{submit:function(){var t=this;this.formData.contract_type_id=this.contract_type.id,r["a"].post(m.assign,this.formData).then((function(){return t.$toasted.success("Contract date assigned")})).then((function(){return t.reloadDates()})).then((function(){return t.showAssignModal=!1})).catch((function(e){return t.$toasted.error(e.message)}))},startDrag:function(t,e){t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",this.draggingId=e.id},dragOver:function(t){this.dragOverId=parseInt(t.target.dataset.id)},onDrop:function(){this.$emit("reorder",[this.draggingId,this.dragOverId]),this.draggingId=this.dragOverId=null},closeModal:function(){this.showAssignModal=!1,this.formData={contract_date_id:null,order:null,is_required:!1}}}},y=b,C=(a("670c"),Object(l["a"])(y,_,h,!1,null,"717d304d",null)),D=C.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h4",[t._v("Add Dates "),a("button",{staticClass:"btn btn-sm btn-icon btn-success",on:{click:function(e){t.showAssignModal=!0}}},[a("i",{staticClass:"fa fa-plus"})])]),t.templates.length>0?a("div",[a("div",{staticClass:"drop-zone"},t._l(t.templates,(function(e){return a("div",{key:e.is,staticClass:"border rounded p-2 m-2 clearfix"},[t._v(" "+t._s(e.label)+" "),a("button",{staticClass:"btn btn-danger btn-sm float-right",on:{click:function(a){return t.removeTemplate(e)}}},[a("i",{staticClass:"far fa-trash-alt"})])])})),0)]):a("div",[t._v(" No date assigned to the contract type ")]),a("CModal",{attrs:{title:"Assign template to contract type",color:"success","close-on-backdrop":!1,show:t.showAssignModal},on:{"update:show":function(e){t.showAssignModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("div",{staticClass:"d-block w-100"},[a("button",{staticClass:"d-inline-block btn btn-secondary",on:{click:t.closeModal}},[t._v("Close")]),a("button",{staticClass:" d-inline-block btn btn-success float-right",on:{click:t.submit}},[t._v("Assign")])])]},proxy:!0}])},[a("div",{staticClass:"form-group"},[a("label",[t._v("Template")]),a("v-select",{attrs:{options:t.available_templates,reduce:function(t){return t.id},label:"label"},model:{value:t.formData.template_id,callback:function(e){t.$set(t.formData,"template_id",e)},expression:"formData.template_id"}})],1)])],1)},M=[],A=a("4a7a"),k=a.n(A),T=(a("6dfc"),{name:"ContractTemplateTable",props:{contract_type:{type:Object},templates:{type:Array,required:!0},reload:{type:Function}},components:{vSelect:k.a},data:function(){return{showAssignModal:!1,draggingId:null,dragOverId:null,all_templates:[],formData:{template_id:null}}},computed:{available_templates:function(){var t=this.templates.map((function(t){return t.id}));return g.a.filter(this.all_templates,(function(e){return-1===t.indexOf(e.id)}))}},mounted:function(){var t=this;r["a"].get(m.all_templates).then((function(e){var a=e.data;return t.all_templates=a})).catch((function(e){var a=e.error;return t.$toasted.error(a.message())}))},methods:{submit:function(){var t=this;r["a"].post(m.assign_templates(this.contract_type.id),this.formData).then((function(){return t.$toasted.success("Template assigned")})).then((function(){return t.reload()})).then((function(){return t.closeModal()})).catch((function(e){return t.$toasted.error(e.message)}))},removeTemplate:function(t){var e=this;confirm("Are you sure to remove the template?")&&r["a"].delete(m.remove_templates(this.contract_type.id,t.id)).then((function(){return e.$toasted.success("Template removed")})).then((function(){return e.reload()})).then((function(){return e.closeModal()})).catch((function(t){return e.$toasted.error(t.message)}))},closeModal:function(){this.showAssignModal=!1,this.formData={template_id:null}}}}),$=T,x=(a("866d"),Object(l["a"])($,w,M,!1,null,"1f910986",null)),O=x.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h4",[t._v("Add Documents "),a("button",{staticClass:"btn btn-sm btn-icon btn-success",on:{click:function(e){t.showAssignModal=!0}}},[a("i",{staticClass:"fa fa-plus"})])]),t.documents.length>0?a("div",[a("div",{staticClass:"drop-zone",on:{drop:function(e){return t.onDrop(e,1)},dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()}}},t._l(t.ordered_docs,(function(e){return a("div",{key:e.is,staticClass:"drag-el border rounded p-2",attrs:{draggable:"","data-id":e.id},on:{dragstart:function(a){return t.startDrag(a,e)},dragover:function(a){return t.dragOver(a,e)}}},[t._v(" "+t._s(e.label)+" "),e.is_required?a("span",{staticClass:"badge badge-info"},[t._v("Required")]):t._e()])})),0)]):a("div",[t._v(" No date assigned to the contract type ")]),a("CModal",{attrs:{title:"Assign document to contract type",color:"success",show:t.showAssignModal},on:{"update:show":function(e){t.showAssignModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("div",{staticClass:"d-block w-100"},[a("button",{staticClass:"d-inline-block btn btn-secondary",on:{click:t.closeModal}},[t._v("Close")]),a("button",{staticClass:" d-inline-block btn btn-success float-right",on:{click:t.submit}},[t._v("Assign")])])]},proxy:!0}])},[a("div",{staticClass:"form-group"},[a("label",[t._v("Document")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.contract_doc_id,expression:"formData.contract_doc_id"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.formData,"contract_doc_id",e.target.multiple?a:a[0])}}},t._l(t.available_docs,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.label))])})),0)]),a("div",{staticClass:"form-group"},[a("label",[t._v("Order")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.order,expression:"formData.order"}],staticClass:"form-control",attrs:{type:"number",min:"0"},domProps:{value:t.formData.order},on:{input:function(e){e.target.composing||t.$set(t.formData,"order",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",[t._v("Is required")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.is_required,expression:"formData.is_required"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.formData,"is_required",e.target.multiple?a:a[0])}}},[a("option",{domProps:{value:!0}},[t._v("Required")]),a("option",{domProps:{value:!1}},[t._v("Optional")])])])])],1)},I=[],N={name:"ContractDocumentTable",props:{contract_type:{type:Object},documents:{type:Array,required:!0},reloadDocuments:{type:Function,required:!0}},data:function(){return{showAssignModal:!1,draggingId:null,dragOverId:null,all_documents:[],formData:{contract_doc_id:null,order:null,is_required:!1}}},computed:{ordered_docs:function(){return g.a.sortBy(this.documents,["order","label"])},available_docs:function(){var t=this.documents.map((function(t){return t.id}));return g.a.filter(this.all_documents,(function(e){return-1===t.indexOf(e.id)}))}},mounted:function(){var t=this;r["a"].get(m.all_docs).then((function(e){var a=e.data;return t.all_documents=a})).catch((function(e){var a=e.error;return t.$toasted.error(a.message())}))},methods:{submit:function(){var t=this;this.formData.contract_type_id=this.contract_type.id,r["a"].post(m.assign_doc,this.formData).then((function(){return t.$toasted.success("Contract date assigned")})).then((function(){return t.reloadDocuments()})).then((function(){return t.showAssignModal=!1})).catch((function(e){return t.$toasted.error(e.message)}))},startDrag:function(t,e){t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",this.draggingId=e.id},dragOver:function(t){this.dragOverId=parseInt(t.target.dataset.id)},onDrop:function(){this.$emit("reorder",[this.draggingId,this.dragOverId]),this.draggingId=this.dragOverId=null},closeModal:function(){this.showAssignModal=!1,this.formData={contract_doc_id:null,order:null,is_required:!1}}}},j=N,P=(a("c62f"),Object(l["a"])(j,q,I,!1,null,"3402b2d2",null)),S=P.exports,z={name:"ContractTypeIndex",components:{ContractTypeForm:f,ContractDateTable:D,ContractDocumentTable:S,ContractTemplateTable:O},data:function(){return{showCreateModal:!1,showAssignModal:!1,showAssignDocumentModal:!1,showTemplateModal:!1,selected_contract_type:null,isLoading:!0,fields:[{key:"label"},{key:"actions",sorter:!1,filter:!1}],items:[],formData:{label:null}}},computed:{dates:function(){var t;return(null===(t=this.selected_contract_type)||void 0===t?void 0:t.contract_dates)||[]},documents:function(){var t;return(null===(t=this.selected_contract_type)||void 0===t?void 0:t.contract_documents)||[]},templates:function(){var t;return(null===(t=this.selected_contract_type)||void 0===t?void 0:t.templates)||[]}},created:function(){this.fetchContractTypes()},methods:{showAttachModal:function(t){this.selected_contract_type=t,this.showAssignModal=!0},showAttachDocumentModal:function(t){this.selected_contract_type=t,this.showAssignDocumentModal=!0},showAssignTemplate:function(t){this.selected_contract_type=t,this.showTemplateModal=!0},fetchContractType:function(){var t=this;r["a"].get(m.show(this.selected_contract_type.id)).then((function(e){var a=e.data;return t.selected_contract_type=a})).then((function(){return t.items=t.items.map((function(e){return e.id===t.selected_contract_type.id?t.selected_contract_type:e}))})).catch((function(e){return t.$toasted.error(e.message)}))},fetchContractTypes:function(){var t=this;r["a"].get(m.list).then((function(e){var a=e.data;return t.items=a})).then((function(){return t.isLoading=!1})).catch((function(e){return t.$toasted.error(e.message)}))},submit:function(){var t=this;r["a"].post(m.store,this.formData).then((function(e){var a=e.data;return t.items.push(a)})).then((function(){return t.formDate={label:null}})).then((function(){return t.showCreateModal=!1})).catch((function(e){return t.$toasted.error(e.message)}))},updateDoc:function(t,e){var a=this,n={contract_type_id:this.selected_contract_type.id,contract_doc_1_id:t,contract_doc_2_id:e};r["a"].post(m.ordering_doc,n).then((function(){return a.$toasted.success("New order saved")})).catch((function(t){return a.$toasted.error(t.message)}))},updateOrder:function(t,e){var a=this,n={contract_type_id:this.selected_contract_type.id,contract_date_1_id:t,contract_date_2_id:e};r["a"].post(m.ordering,n).then((function(){return a.$toasted.success("New order saved")})).catch((function(t){return a.$toasted.error(t.message)}))},reorder:function(t){this.updateOrder(t[0],t[1]);var e=this.selected_contract_type.contract_dates.find((function(e){return e.id===t[0]})),a=this.selected_contract_type.contract_dates.find((function(e){return e.id===t[1]})),n=e.order;e.order=a.order,a.order=n,this.selected_contract_type.contract_dates=this.selected_contract_type.contract_dates.map((function(t){return t.id===e.id?e:t.id===a.id?a:t}))},reorderDoc:function(t){this.updateDocOrder(t[0],t[1]);var e=this.selected_contract_type.contract_documents.find((function(e){return e.id===t[0]})),a=this.selected_contract_type.contract_documents.find((function(e){return e.id===t[1]})),n=e.order;e.order=a.order,a.order=n,this.selected_contract_type.contract_documents=this.selected_contract_type.contract_documents.map((function(t){return t.id===e.id?e:t.id===a.id?a:t}))}}},E=z,F=Object(l["a"])(E,n,o,!1,null,"d1e6b610",null);e["default"]=F.exports},"670c":function(t,e,a){"use strict";a("8882")},"866d":function(t,e,a){"use strict";a("e2b8")},8882:function(t,e,a){},c62f:function(t,e,a){"use strict";a("ff0b")},e2b8:function(t,e,a){},ff0b:function(t,e,a){}}]);