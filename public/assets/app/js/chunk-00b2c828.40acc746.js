(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00b2c828"],{"979e":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ShowInvoice"},[t.invoice?i("CCard",[i("CCardHeader",[i("h4",[t._v(" Invoice "),i("router-link",{staticClass:"btn btn-info btn-sm mr-3",attrs:{to:"/invoices/"+t.invoice.id+"/print"}},[i("i",{staticClass:"fa fa-print"}),t._v(" Print Invoice ")]),t.canEdit&&"superseded"!==t.invoice.status?i("router-link",{staticClass:"btn btn-info btn-sm",attrs:{to:{name:"Edit Invoice",params:{id:t.$route.params.id}}}},[i("i",{staticClass:"far fa-edit"}),t._v(" Edit ")]):t._e(),"superseded"!==t.invoice.status?i("router-link",{staticClass:"btn btn-success btn-sm float-right ml-3",attrs:{to:{name:"Payments",query:{invoice_id:t.$route.params.id}}}},[i("i",{staticClass:"fa fa-plus"}),t._v(" Payment ")]):t._e(),"superseded"!==t.invoice.status?i("router-link",{staticClass:"mr-3 btn btn-primary btn-sm float-right",attrs:{to:{name:"Invoice Trail",params:{id:t.$route.params.id}}}},[i("i",{staticClass:"fas fa-history"}),t._v(" Trail ")]):t._e()],1)]),i("CCardBody",[i("ShowInvoiceForm",{attrs:{invoice:t.invoice}})],1)],1):i("CCard",[i("CCardHeader",[i("h4",[t._v("Loading...")])])],1)],1)},a=[],s=i("ebe3"),o=i("7ed9"),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ShowInvoice"},[i("fieldset",[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-6"},[i("div",{staticClass:"form-group"},[i("label",[t._v("Client:")]),i("span",[i("router-link",{attrs:{to:{name:"Client",params:{id:t.invoice.client_id}}}},[t._v(" "+t._s(t.invoice.client.prefix)+" "+t._s(t.invoice.client.full_name)+" ")])],1)])]),i("div",{staticClass:"col-md-6"},[i("div",{staticClass:"form-group"},[i("label",[t._v("Contract:")]),i("span",[i("router-link",{attrs:{to:{name:"Contract",params:{id:t.invoice.contract.id}}}},[t._v(" "+t._s(t.invoice.contract.contract_number)+" ")])],1)])])])]),i("fieldset",[i("h5",[t._v("Invoice Items ")]),i("div",{staticClass:"table-responsive"},[i("table",{staticClass:"table"},[t._m(0),i("tbody",[t._l(t.invoice.items,(function(e){return i("tr",{key:e.uuid},[i("td",[i("router-link",{attrs:{to:{name:"Product",params:{id:e.sellable_id}}}},[t._v(" "+t._s(e.sellable.name)+" ")])],1),i("td",[t._v(" "+t._s(e.variant?e.variant.name:"")+" ")]),i("td",{staticStyle:{width:"70px"}},[t._v(" "+t._s(e.qty)+" ")]),i("td",[t._v(" "+t._s(e.note)+" ")]),i("td",{staticStyle:{width:"120px"}},[t._v(" "+t._s(t._f("formatCurrency")(e.price))+" ")]),i("td",{staticStyle:{width:"120px"}},[t._v(" "+t._s(t._f("formatCurrency")(e.discount))+" ")]),i("td",{staticStyle:{width:"150px"}},[t._v(" "+t._s(t._f("formatCurrency")(e.price*e.qty-e.discount))+" ")])])})),t.previousInvoice?i("tr",[i("td",[t._v(" Supersede Invoice ")]),i("td"),i("td",{staticStyle:{width:"70px"}},[t._v(" 1 ")]),i("td",[t._v(" This line is to supersede the previous invoice: "+t._s(t.previousPaymentsSummary)+" ")]),i("td",{staticStyle:{width:"120px"}},[t._v(" "+t._s(t._f("formatCurrency")(-t.previousPaymentsTotal))+" ")]),i("td",{staticStyle:{width:"120px"}},[t._v(" 0 ")]),i("td",{staticStyle:{width:"150px"}},[t._v(" "+t._s(t._f("formatCurrency")(-t.previousPaymentsTotal))+" ")]),i("td")]):t._e()],2)])]),i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-6"},[i("label",[t._v("Note:")]),i("p",[t._v(t._s(t.invoice.note))])]),i("div",{staticClass:"col-sm-6"},[i("table",{staticClass:"table"},[i("tbody",[i("tr",[i("td",[t._v("Subtotal")]),i("td",[t._v(t._s(t._f("formatCurrency")(t.subtotal)))])]),i("tr",[i("td",[t._v("Discount")]),i("td",[t._v(" "+t._s(t._f("formatCurrency")(t.invoice.discount))+" ")])]),i("tr",[i("td",[t._v("Net Total")]),i("td",[t._v(t._s(t._f("formatCurrency")(t.nettotal)))])])])])])])])])},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("th",[t._v("Product")]),i("th",[t._v("Variant")]),i("th",[t._v("Qty")]),i("th",[t._v("Note")]),i("th",[t._v("Price")]),i("th",[t._v("Discount")]),i("th",[t._v("Subtotal")])])])}],u=i("44f1"),v=i("9b3a"),l={name:"ShowInvoice",props:{invoice:{type:Object,required:!0}},filters:{formatCurrency:u["b"]},mixins:[v["a"]],computed:{previousInvoice:function(){return this.invoice.previousInvoice},subtotal:function(){var t=this,e=this.invoice.items.reduce((function(e,i){return e+t.calculateSubTotal(i)}),0);return this.previousInvoice&&(e-=this.previousPaymentsTotal),e},nettotal:function(){return this.invoice.discount?this.subtotal-this.invoice.discount:this.subtotal}},methods:{calculateSubTotal:function(t){return t.qty*t.price-t.discount}}},d=l,_=i("2877"),m=Object(_["a"])(d,c,r,!1,null,"615edbf3",null),f=m.exports,p={name:"ShowInvoice",components:{ShowInvoiceForm:f},data:function(){return{invoice:null}},computed:{canEdit:function(){return this.$store.getters.can("agency-finance:invoice.edit")}},created:function(){this.fetchInvoice()},methods:{fetchInvoice:function(){var t=this;o["a"].get(s["a"].show(this.$route.params.id)).then((function(e){var i=e.data;t.invoice=i})).catch((function(t){return console.log(t)}))}}},h=p,y=Object(_["a"])(h,n,a,!1,null,"6c454079",null);e["default"]=y.exports},"9b3a":function(t,e,i){"use strict";e["a"]={computed:{previousPaymentsSummary:function(){return this.getPayments().reduce((function(t,e){return t+="".concat(e.amount," ").concat(e.created_at,"\n"),t}),"\n")},previousPaymentsTotal:function(){return this.getPayments().reduce((function(t,e){return t+=e.amount,t}),0)}},methods:{getPayments:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t=t||this.previousInvoice,t&&(e=e.concat(t.payments),t.previousInvoice&&this.getPayments(t.previousInvoice,e)),e}}}},ebe3:function(t,e,i){"use strict";var n={list:"/api/agencyfinance/invoices",store:"/api/agencyfinance/invoices",show:function(t){return"/api/agencyfinance/invoices/".concat(t)},update:function(t){return"/api/agencyfinance/invoices/".concat(t)},supersede:function(t){return"/api/agencyfinance/invoices/".concat(t,"/supersede")},trail:function(t){return"/api/agencyfinance/invoices/".concat(t,"/trail")}};e["a"]=n}}]);