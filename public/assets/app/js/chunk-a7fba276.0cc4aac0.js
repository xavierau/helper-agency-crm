(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a7fba276"],{4040:function(t,e,a){},"972b":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ApplicantShow"},[!1===t.isLoading?a("CCard",[a("CCardHeader",{staticClass:"d-flex justify-content-between align-content-center"},[a("h4",{staticClass:"m-0"},[t._v(t._s(t.workflow.label)+" "),a("small",[t._v("("+t._s(t.workflow.code)+")")])])]),a("CCardBody",[a("section",{staticClass:"graph-container"},[a("workflow-diagram",{staticStyle:{height:"300px"},attrs:{workflow:t.workflow}})],1),a("section",[a("h5",[t._v("Transitions "),a("button",{staticClass:"btn-success btn btn-icon btn-sm",on:{click:function(e){t.showCreateTransitionModal=!0}}},[a("i",{staticClass:"fa fa-plus"})])]),a("CDataTable",{attrs:{items:t.workflow.transitions,fields:["label","code",{key:"from_state.label",label:"From State"},{key:"to_state.label",label:"to State"},"actions"],loading:t.isLoading,hover:"","items-per-page":15,"column-filter":"","table-filter":"",sorter:""},scopedSlots:t._u([{key:"from_state.label",fn:function(e){var n=e.item;return[a("td",[t._v(t._s(n.from_state.label))])]}},{key:"to_state.label",fn:function(e){var n=e.item;return[a("td",[t._v(t._s(n.to_state.label))])]}},{key:"actions",fn:function(e){var n=e.item;return[a("td",[a("button",{staticClass:"btn btn-sm btn-icon btn-danger",on:{click:function(e){return t.deleteTransition(n)}}},[a("i",{staticClass:"fa fa-trash"})])])]}}],null,!1,2927889191)}),a("hr")],1),a("section",[a("h5",[t._v("States "),a("button",{staticClass:"btn-success btn btn-icon btn-sm",on:{click:function(e){t.showCreateStateModal=!0}}},[a("i",{staticClass:"fa fa-plus"})])]),a("CDataTable",{attrs:{items:t.workflow.states,fields:["label","code","is_initial","actions"],loading:t.isLoading,hover:"","items-per-page":15,"column-filter":"","table-filter":"",sorter:""},scopedSlots:t._u([{key:"actions",fn:function(e){var n=e.item;return[a("td",[a("button",{staticClass:"btn btn-sm btn-icon btn-danger",on:{click:function(e){return t.deleteState(n)}}},[a("i",{staticClass:"fa fa-trash"})])])]}},{key:"is_initial",fn:function(e){var n=e.item;return[a("td",[a("span",{staticClass:"badge",class:{"badge-success":n.is_initial,"badge-warning":!n.is_initial}},[t._v(" "+t._s(n.is_initial?"Initial State":"Normal State")+" ")])])]}}],null,!1,1903594735)}),a("hr")],1)]),a("CModal",{attrs:{title:"Create Transition",color:"success",size:"xl",show:t.showCreateTransitionModal},on:{"update:show":function(e){t.showCreateTransitionModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("button",{staticClass:"btn btn-secondary btn-sm",on:{click:function(e){t.showCreateTransitionModal=!1}}},[t._v(" Close ")]),a("button",{staticClass:"btn btn-success btn-sm",on:{click:t.createTransition}},[t._v(" Submit ")])]},proxy:!0}],null,!1,2052418626)},[a("div",{staticClass:"form"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"transition-label"}},[t._v("Transition Label")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.transition.label,expression:"transition.label"}],staticClass:"form-control",attrs:{type:"text",id:"transition-label"},domProps:{value:t.transition.label},on:{input:function(e){e.target.composing||t.$set(t.transition,"label",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"transition-code"}},[t._v("Transition Code")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.transition.code,expression:"transition.code"}],staticClass:"form-control",attrs:{type:"text",id:"transition-code"},domProps:{value:t.transition.code},on:{input:function(e){e.target.composing||t.$set(t.transition,"code",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"transition-from-state"}},[t._v("From State")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.transition.from_state_id,expression:"transition.from_state_id"}],staticClass:"form-control",attrs:{type:"text",id:"transition-from-state"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.transition,"from_state_id",e.target.multiple?a:a[0])}}},t._l(t.workflow.states,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.label)+" ("+t._s(e.code)+") ")])})),0)]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"transition-to-state"}},[t._v("To State")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.transition.to_state_id,expression:"transition.to_state_id"}],staticClass:"form-control",attrs:{type:"text",id:"transition-to-state"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.transition,"to_state_id",e.target.multiple?a:a[0])}}},t._l(t.workflow.states,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.label)+" ("+t._s(e.code)+") ")])})),0)])])]),a("CModal",{attrs:{title:"Create State",color:"success",size:"xl",show:t.showCreateStateModal},on:{"update:show":function(e){t.showCreateStateModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("button",{staticClass:"btn btn-secondary btn-sm",on:{click:function(e){t.showCreateStateModal=!1}}},[t._v(" Close ")]),a("button",{staticClass:"btn btn-success btn-sm",on:{click:t.createState}},[t._v(" Submit ")])]},proxy:!0}],null,!1,3060875714)},[a("div",{staticClass:"form"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"state-label"}},[t._v("State Label")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.state.label,expression:"state.label"}],staticClass:"form-control",attrs:{type:"text",id:"state-label"},domProps:{value:t.state.label},on:{input:function(e){e.target.composing||t.$set(t.state,"label",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"state-code"}},[t._v("State Code")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.state.code,expression:"state.code"}],staticClass:"form-control",attrs:{type:"text",id:"state-code"},domProps:{value:t.state.code},on:{input:function(e){e.target.composing||t.$set(t.state,"code",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"state-is_initial"}},[t._v("Is Initial State")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.state.is_initial,expression:"state.is_initial"}],staticClass:"form-control",attrs:{id:"state-is_initial"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.state,"is_initial",e.target.multiple?a:a[0])}}},[a("option",{domProps:{value:!1}},[t._v("No")]),a("option",{domProps:{value:!0}},[t._v("Yes")])])])])])],1):a("CCard",[a("CCardBody",[t._v("Loading...")])],1)],1)},o=[],s=a("c53c"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"cy"})},r=[],l=a("44e1"),c=a.n(l),u=a("8df5"),d=a.n(u),f=a("b17d"),m=a.n(f);c.a.use(d.a),c.a.use(m.a);var p={name:"WorkflowDiagram",props:{workflow:{type:Object,required:!0}},watch:{workflow:function(){this.draw()}},mounted:function(){this.draw()},methods:{draw:function(){var t=this.workflow.states.map((function(t){return{data:{id:"s_".concat(t.id),label:t.label}}})),e=this.workflow.transitions.map((function(t){return{data:{id:"t_".concat(t.id),label:t.label,source:"s_".concat(t.from_state.id),target:"s_".concat(t.to_state.id)}}})),a=t.concat(e),n=window.innerHeight>window.innerWidth?"dagre":"klay";c()({container:this.$refs.cy,elements:a,style:[{selector:"node",style:{height:10,width:10,"font-size":"6px","background-color":"#1e4df3",label:"data(label)"}},{selector:"edge",style:{label:"data(label)","font-size":"5px",width:2,"line-color":"#ccc","target-arrow-color":"#ccc","target-arrow-shape":"triangle","curve-style":"bezier"}}],layout:{name:n}})}}},w=p,b=a("2877"),v=Object(b["a"])(w,i,r,!1,null,"a94da6ac",null),_=v.exports,h=a("7ed9"),g={name:"ShowIndex",data:function(){return{isLoading:!0,workflow:null,showCreateTransitionModal:!1,showCreateStateModal:!1,transition:{label:null,code:null,from_state_id:null,to_state_id:null},state:{label:null,code:null,is_initial:!1}}},components:{WorkflowDiagram:_},created:function(){this.fetchWorkflow()},methods:{fetchWorkflow:function(){var t=this;h["a"].get(s["a"].show(this.$route.params.id)).then((function(e){var a=e.data;return t.workflow=a})).then((function(){return t.isLoading=!1})).catch((function(t){return console.log(t)}))},createTransition:function(){var t=this;h["a"].post(s["a"].create_transition(this.$route.params.id),this.transition).then((function(e){var a=e.data;return t.workflow.transitions.push(a.transition)})).then((function(){return t.showCreateTransitionModal=!1})).catch((function(t){return console.log(t)}))},deleteTransition:function(t){var e=this;confirm("are you sure to delete the transition?")&&h["a"].delete(s["a"].delete_transition(this.$route.params.id,t.id)).then((function(){return e.workflow.transitions=e.workflow.transitions.filter((function(e){return e.id!==t.id}))})).catch((function(t){return console.log(t)}))},createState:function(){var t=this;h["a"].post(s["a"].create_state(this.$route.params.id),this.state).then((function(e){var a=e.data;return t.workflow.states.push(a.state)})).then((function(){return t.showCreateStateModal=!1})).then((function(){return t.state={label:null,code:null,is_initial:!1}})).catch((function(t){return console.log(t)}))}}},C=g,k=(a("bf5f"),Object(b["a"])(C,n,o,!1,null,"7de985a4",null));e["default"]=k.exports},bf5f:function(t,e,a){"use strict";a("4040")},c53c:function(t,e,a){"use strict";var n={entities:"/api/agencycore/entities",list:"/api/workflows",store:"/api/workflows",assign_entity:function(t){return"/api/workflows/".concat(t,"/entities")},show:function(t){return"/api/workflows/".concat(t)},create_transition:function(t){return"/api/workflows/".concat(t,"/transitions/")},update_transition:function(t,e){return"/api/workflows/".concat(t,"/transitions/").concat(e)},delete_transition:function(t,e){return"/api/workflows/".concat(t,"/transitions/").concat(e)},create_state:function(t){return"/api/workflows/".concat(t,"/states/")},update_state:function(t,e){return"/api/workflows/".concat(t,"/states/").concat(e)},delete_state:function(t,e){return"/api/workflows/".concat(t,"/states/").concat(e)}};e["a"]=n}}]);