(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20862d"],{a525:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"showSellable"},[t.sellable?a("CCard",[a("CCardHeader",[a("h4",[t._v("Product "),a("router-link",{staticClass:"btn btn-primary btn-sm",attrs:{to:{name:"Product Template",params:{product_id:t.sellable.id}}}},[t._v("Template ")])],1)]),a("CCardBody",[a("div",{staticClass:"form-group"},[a("label",[t._v("Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.sellable.name,expression:"sellable.name"}],staticClass:"form-control",attrs:{disabled:!t.canEdit},domProps:{value:t.sellable.name},on:{input:function(e){e.target.composing||t.$set(t.sellable,"name",e.target.value)}}})]),0===t.sellable.variants.length?a("div",[a("div",{staticClass:"form-group"},[a("label",[t._v("Price")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.sellable.price,expression:"sellable.price"}],staticClass:"form-control",attrs:{type:"number",step:"0.1",min:"0",disabled:!t.canEdit},domProps:{value:t.sellable.price},on:{input:function(e){e.target.composing||t.$set(t.sellable,"price",e.target.value)}}})]),t.sellable.track_inventory?a("div",{staticClass:"form-group"},[a("label",[t._v("Inventory")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.sellable.inventory,expression:"sellable.inventory"}],staticClass:"form-control",attrs:{disabled:!t.canEdit},domProps:{value:t.sellable.inventory},on:{input:function(e){e.target.composing||t.$set(t.sellable,"inventory",e.target.value)}}})]):t._e()]):t._e(),a("div",{staticClass:"form-group"},[a("label",[t._v("Description")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.sellable.description,expression:"sellable.description"}],staticClass:"form-control",attrs:{disabled:!t.canEdit},domProps:{value:t.sellable.description},on:{input:function(e){e.target.composing||t.$set(t.sellable,"description",e.target.value)}}})]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[t._v("Is Active "),a("CSwitch",{staticClass:"ml-3 pt-2",attrs:{disabled:!t.canEdit,color:"success",checked:t.sellable.is_active},on:{"update:checked":function(e){t.sellable.is_active=!t.sellable.is_active}}})],1)])]),a("div",{staticClass:"col-6 col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[t._v("Track Inventory "),a("CSwitch",{staticClass:"ml-3 pt-2",attrs:{disabled:!t.canEdit,color:"success",checked:t.sellable.track_inventory},on:{"update:checked":function(e){t.sellable.track_inventory=!t.sellable.track_inventory}}})],1)])]),a("div",{staticClass:"col-6 col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[t._v("Editable "),a("CSwitch",{staticClass:"ml-3 pt-2",attrs:{disabled:!t.canEdit,color:"success",checked:t.sellable.editable},on:{"update:checked":function(e){t.sellable.editable=!t.sellable.editable}}})],1)])])]),a("div",{staticClass:"form-group d-flex justify-content-between"},[a("router-link",{staticClass:"btn btn-secondary",attrs:{to:{name:"Products"}}},[t._v("Back ")]),t.canEdit?a("button",{staticClass:"btn btn-success ml-auto",on:{click:t.updateSellable}},[t._v("Update Product ")]):t._e()],1),a("section",[a("h4",[t._v("Variants "),t.canEdit?a("button",{staticClass:"btn btn-success btn-sm",on:{click:function(e){t.showAddVariantModal=!0}}},[a("i",{staticClass:"fa fa-plus"})]):t._e()]),t.sellable.variants.length>0?a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",[t._v("Variant name")]),a("th",[t._v("Price")]),t.sellable.track_inventory?a("th",[t._v("Inventory")]):t._e(),a("th",[t._v("Description")]),a("th",[t._v("Is Active")]),t.canEdit?a("th",[t._v("Actions")]):t._e()])]),a("tbody",t._l(t.$options.filters.sortBy(t.sellable.variants,"name"),(function(e){return a("tr",{key:e.id},[a("td",[t._v(t._s(e.name))]),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.pivot.price,expression:"variant.pivot.price"}],staticClass:"form-control",attrs:{disabled:!t.canEdit},domProps:{value:e.pivot.price},on:{input:function(a){a.target.composing||t.$set(e.pivot,"price",a.target.value)}}})]),t.sellable.track_inventory?a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.pivot.inventory,expression:"variant.pivot.inventory"}],staticClass:"form-control",attrs:{disabled:!t.canEdit},domProps:{value:e.pivot.inventory},on:{input:function(a){a.target.composing||t.$set(e.pivot,"inventory",a.target.value)}}})]):t._e(),a("td",[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.pivot.description,expression:"variant.pivot.description"}],staticClass:"form-control",attrs:{disabled:!t.canEdit},domProps:{value:e.pivot.description},on:{input:function(a){a.target.composing||t.$set(e.pivot,"description",a.target.value)}}})]),a("td",[a("CSwitch",{attrs:{color:"success",disabled:!t.canEdit,checked:e.pivot.is_active},on:{"update:checked":function(t){e.pivot.is_active=!e.pivot.is_active}}})],1),t.canEdit?a("td",[a("CButtonGroup",{attrs:{size:"sm"}},[a("button",{staticClass:"btn btn-sm btn-success",on:{click:function(a){return t.updateVariant(e)}}},[t._v("Update ")]),a("CDropdown",{attrs:{color:"secondary","toggler-text":"More"}},[a("CDropdownItem",{attrs:{to:{name:"Product Variant Template",params:{product_id:t.sellable.id,variant_id:e.id}}}},[a("i",{staticClass:"fa fa-print mr-1"}),t._v("Template ")]),a("CDropdownDivider"),a("CDropdownItem",{on:{click:function(a){return t.removeVariant(e)}}},[a("i",{staticClass:"fa fa-trash-alt mr-1"}),t._v("Delete ")]),a("CDropdownItem",{attrs:{disabled:""}},[t._v("Disabled action")])],1)],1)],1):t._e()])})),0)]),t._v(" ShowSellable ")]):a("p",[a("em",[t._v("No variant")])])])])],1):a("CCard",[a("CCardHeader",[a("h4",[t._v("Loading...")])])],1),t.canEdit?a("CModal",{attrs:{title:"Add variant",show:t.showAddVariantModal},on:{"update:show":function(e){t.showAddVariantModal=!1}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("button",{staticClass:"btn btn-secondary btn-sm",on:{click:function(e){t.showAddVariantModal=!1}}},[t._v("Close")]),a("button",{staticClass:"btn btn-success btn-sm ml-auto",on:{click:t.addVariant}},[t._v("Add")])]},proxy:!0}],null,!1,92798740)},[a("div",{staticClass:"form-group"},[a("label",[t._v("Available Variants")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.selected_variants,expression:"selected_variants"}],staticClass:"form-control",attrs:{multiple:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected_variants=e.target.multiple?a:a[0]}}},t._l(t.variants,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),0)])]):t._e()],1)},s=[],i=a("babe"),l=a("7ed9"),r=a("44f1"),o=a("2ef0"),c=a.n(o),d={name:"ShowSellable",data:function(){return{showAddVariantModal:!1,sellable:null,allVariants:[],selected_variants:[]}},filters:{sortBy:r["f"]},computed:{canEdit:function(){return this.$store.getters.can("agency-core:sellable.edit")},variants:function(){if(this.sellable){var t=c.a.reduce(this.sellable.variants,(function(t,e){return t.push(e.id),t}),[]);return c.a.chain(this.allVariants).filter((function(e){return-1===t.indexOf(e.id)})).sortBy(["name"]).value()}return this.allVariants}},created:function(){var t=this;l["a"].get(i["a"].show(this.$route.params.id)).then((function(e){var a=e.data;return t.sellable=a})).catch((function(t){return console.log(t)})),l["a"].get(i["a"].variants).then((function(e){var a=e.data;return t.allVariants=a})).catch((function(t){return console.log(t)}))},methods:{updateSellable:function(){var t=this;!1!==this.canEdit&&l["a"].put(i["a"].update(this.sellable.id),this.sellable).then((function(e){var a=e.data;return t.sellable=a})).then((function(){return t.$toasted.success("Product is updated!")})).catch((function(e){return t.$toasted.error("Something wrong! Try again later!")}))},addVariant:function(){var t=this;l["a"].post(i["a"].add_product_variants(this.sellable.id),{variants:this.selected_variants}).then((function(e){var a=e.data;return t.sellable=a})).then((function(){return t.showAddVariantModal=!1})).then((function(){return t.selected_variants=[]})).catch((function(t){return console.log(t)}))},removeVariant:function(t){var e=this;confirm("Are you sure to delete the variant?")&&l["a"].delete(i["a"].remove_variants(this.sellable.id,t.id)).then((function(t){var a=t.data;return e.sellable=a})).then((function(){return e.showAddVariantModal=!1})).catch((function(t){return console.log(t)}))},updateVariant:function(t){var e=this;l["a"].put(i["a"].update_variants(this.sellable.id,t.id),t).then((function(){return e.$toasted.success("Variant: ".concat(t.name," is updated"))})).catch((function(t){return console.log(t)}))}}},u=d,v=a("2877"),p=Object(v["a"])(u,n,s,!1,null,"6cc6df28",null);e["default"]=p.exports}}]);