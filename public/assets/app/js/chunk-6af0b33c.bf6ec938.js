(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6af0b33c"],{"754e":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"WorkflowIndex"},[o("CCard",[o("CCardHeader",{staticClass:"d-flex justify-content-between align-content-center"},[o("h5",{staticClass:"m-0"},[t._v("Workflows")]),o("button",{staticClass:"btn btn-sm btn-success",on:{click:function(e){t.showCreateModal=!t.showCreateModal}}},[o("i",{staticClass:"fa fa-plus"}),t._v(" Workflow ")])]),t.items?o("CCardBody",[o("CDataTable",{attrs:{items:t.items,fields:t.fields,loading:t.isLoading,hover:"","items-per-page":15,"column-filter":"","table-filter":"",sorter:""},scopedSlots:t._u([{key:"actions",fn:function(e){var a=e.item;return[o("td",[o("router-link",{staticClass:"btn btn-sm btn-icon btn-primary",attrs:{to:{name:"Workflow",params:{id:a.id}}}},[o("i",{staticClass:"fa fa-eye"})]),o("button",{staticClass:"ml-1 btn btn-sm btn-icon btn-info",on:{click:function(e){return t.showAttachModal(a)}}},[o("i",{staticClass:"fas fa-cubes"})])],1)]}}],null,!1,518385559)})],1):o("CCardBody",[o("h4",[t._v("Loading...")])])],1),o("CModal",{attrs:{show:t.showCreateModal,title:"Create New Workflow",color:"success",static:"",size:"xl"},on:{"update:show":function(e){t.showCreateModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[o("button",{staticClass:"btn btn-success",on:{click:t.submit}},[t._v("Create")])]},proxy:!0}])},[o("create-new-workflow-form",{attrs:{"form-data":t.formData},on:{"update:formData":function(e){t.formData=e},"update:form-data":function(e){t.formData=e}}})],1),o("CModal",{attrs:{show:t.showAttachWorkflowModal,title:"Attach "+(t.selectedWorkflow?t.selectedWorkflow.label:null)+" to entity",color:"success",static:"",size:"xl"},on:{"update:show":function(e){t.showAttachWorkflowModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[o("button",{staticClass:"btn btn-secondary",on:{click:t.closeAttachModal}},[t._v("Close")]),o("button",{staticClass:"btn btn-success",on:{click:t.attachWorkflow}},[t._v("Assign")])]},proxy:!0}])},[o("form",{staticClass:"form"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"entity_id"}},[t._v("Entity")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.entity,expression:"entity"}],staticClass:"form-control",attrs:{name:"entity_id",id:"entity_id"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.entity=e.target.multiple?o:o[0]}}},t._l(t.entities,(function(e){return o("option",{key:e,domProps:{value:e}},[t._v(" "+t._s(e.split("\\").pop())+" ")])})),0)])])])],1)},n=[],s=o("c53c"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("form",{staticClass:"form"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"label"}},[t._v("Label")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.label,expression:"formData.label"}],staticClass:"form-control",attrs:{id:"label",type:"text"},domProps:{value:t.formData.label},on:{input:function(e){e.target.composing||t.$set(t.formData,"label",e.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"code"}},[t._v("Code")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.code,expression:"formData.code"}],staticClass:"form-control",attrs:{id:"code",type:"text"},domProps:{value:t.formData.code},on:{input:function(e){e.target.composing||t.$set(t.formData,"code",e.target.value)}}})])])},i=[],l={name:"CreateNewWorkflowForm",props:{formData:{type:Object,required:!0}}},c=l,u=o("2877"),f=Object(u["a"])(c,r,i,!1,null,"4a963a78",null),d=f.exports,w=o("7ed9"),m={name:"WorkflowIndex",components:{CreateNewWorkflowForm:d},data:function(){return{showCreateModal:!1,showAttachWorkflowModal:!1,isLoading:!0,selectedWorkflow:null,entity:null,entities:[],items:null,fields:[{key:"label"},{key:"code"},{key:"actions",sorter:!1,filter:!1}],formData:{label:null,code:null}}},created:function(){var t=this;w["a"].get(s["a"].list).then((function(e){var o=e.data;return t.items=o||[]})).then((function(){return t.isLoading=!1})),w["a"].get(s["a"].entities).then((function(e){var o=e.data;return t.entities=o}))},methods:{showAttachModal:function(t){this.selectedWorkflow=t,this.showAttachWorkflowModal=!0},closeAttachModal:function(){this.showAttachWorkflowModal=!1,this.selectedWorkflow=null},submit:function(){var t=this;w["a"].post(s["a"].store,this.formData).then((function(){return t.$toasted.success("New workflow created")})).then((function(){return t.formData={label:null,code:null}})).then((function(){return t.showCreateModal=!1})).catch((function(e){return t.$toasted.error("Cannot create wrokflow. "+e.message)}))},attachWorkflow:function(){var t=this;w["a"].post(s["a"].assign_entity(this.selectedWorkflow.id),{entity:this.entity}).then((function(){return t.$toasted.success("Workflow attached to entity")})).then((function(){return t.closeAttachModal()})).then((function(){return t.entity_id=null})).catch((function(e){return t.$toasted.error("Cannot create wrokflow. "+e.message)}))}}},p=m,h=Object(u["a"])(p,a,n,!1,null,"e2cca184",null);e["default"]=h.exports},c53c:function(t,e,o){"use strict";var a={entities:"/api/agencycore/entities",list:"/api/workflows",store:"/api/workflows",assign_entity:function(t){return"/api/workflows/".concat(t,"/entities")},show:function(t){return"/api/workflows/".concat(t)},create_transition:function(t){return"/api/workflows/".concat(t,"/transitions/")},update_transition:function(t,e){return"/api/workflows/".concat(t,"/transitions/").concat(e)},delete_transition:function(t,e){return"/api/workflows/".concat(t,"/transitions/").concat(e)},create_state:function(t){return"/api/workflows/".concat(t,"/states/")},update_state:function(t,e){return"/api/workflows/".concat(t,"/states/").concat(e)},delete_state:function(t,e){return"/api/workflows/".concat(t,"/states/").concat(e)}};e["a"]=a}}]);