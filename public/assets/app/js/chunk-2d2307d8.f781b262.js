(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2307d8"],{ed03:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"EditInvoice"},[t.invoice?n("CCard",[n("CCardHeader",[n("h4",{staticClass:"d-block"},[t._v(" Invoice "),n("button",{staticClass:"btn btn-warning btn-sm float-right",on:{click:function(e){return e.preventDefault(),t.showSupersedeModal.apply(null,arguments)}}},[t._v("Supersede Invoice")])])]),n("CCardBody",[n("create-new-invoice-form",{attrs:{"disabled-fields":["client_id","contract.id"],"previous-invoice":t.invoice.previous_invoice,"form-data":t.invoice}}),n("div",{staticClass:"row p-3"},[n("router-link",{staticClass:"btn btn-secondary",attrs:{to:{name:"Invoices"}}},[t._v("Back")]),n("button",{staticClass:"btn btn-success ml-auto",on:{click:function(e){return e.preventDefault(),t.update.apply(null,arguments)}}},[t._v("Update")])],1)],1)],1):n("CCard",[n("CCardHeader",[n("h4",[t._v("Loading...")])])],1),n("CModal",{attrs:{show:t.showSupersede,color:"warning",title:"Supersede Invoice"},on:{"update:show":function(e){t.showSupersede=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[n("button",{staticClass:"btn btn-secondary btn-sm",on:{click:function(e){t.showSupersede=!1}}},[t._v("Close")]),n("button",{staticClass:"btn btn-secondary btn-sm",on:{click:t.supersedeInvoice}},[t._v("Close")])]},proxy:!0}])},[n("CCard",[n("CCardBody",[n("h5",[t._v("New Contract")]),n("my-v-select",{attrs:{options:t.applicants,label:"name","search-func":t.fetchApplicants},model:{value:t.new_applicant,callback:function(e){t.new_applicant=e},expression:"new_applicant"}})],1)],1)],1)],1)},i=[],c=n("ebe3"),o=n("7ed9"),s=n("1613"),r=n("93f0"),u=n("11c1"),d=n("1bbb"),l={name:"EditInvoice",components:{CreateNewInvoiceForm:s["a"],MyVSelect:r["a"]},data:function(){return{showSupersede:!1,invoice:null,new_applicant:null,applicantPaginator:null}},computed:{applicants:function(){return this.applicantPaginator?this.applicantPaginator.data:[]},canEdit:function(){return this.$store.getters.can("agency-finance:invoice.edit")}},created:function(){this.fetchInvoice()},methods:{showSupersedeModal:function(){this.showSupersede=!0},fetchInvoice:function(){var t=this;o["a"].get(c["a"].show(this.$route.params.id)).then((function(e){var n=e.data;n.items.forEach((function(t){return t.uuid=Object(u["v4"])()})),t.invoice=n})).catch((function(t){return console.log(t)}))},update:function(){var t=this;o["a"].put(c["a"].update(this.$route.params.id),this.invoice).then((function(e){e.data;return t.$toasted.success("Invoice is update")})).then((function(){return t.$router.push({name:"Invoices"})})).catch((function(e){return t.$toasted.erro("Something wrong.",e.message)}))},fetchApplicants:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o["a"].get(d["a"].list,{params:{"filter[search]":e}}).then((function(e){var n=e.data;return t.applicantPaginator=n})).catch((function(t){return console.log(t)}))},supersedeInvoice:function(){var t=this,e=Object.assign({},this.invoice);e.items=null,e.invoice_id=this.invoice.id,e.contract.id="new",e.contract.applicant.id=this.new_applicant.id,o["a"].post(c["a"].supersede(this.invoice.id),e).then((function(e){e.data;return t.$toasted.success("new invoice created")})).then((function(){return t.$router.push({name:"Invoices"})})).catch((function(e){return t.$toasted.success("something wrong!"+e.message)}))}}},p=l,h=n("2877"),v=Object(h["a"])(p,a,i,!1,null,"99bea130",null);e["default"]=v.exports}}]);